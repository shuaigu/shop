<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”¨æˆ·IDè°ƒè¯•å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 28px;
        }
        
        .section {
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 18px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .code-block {
            background: #2d3748;
            color: #a0aec0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            overflow-x: auto;
            margin-bottom: 15px;
        }
        
        .code-block .comment {
            color: #68d391;
        }
        
        .code-block .string {
            color: #f6ad55;
        }
        
        .step {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }
        
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 10px;
            font-weight: bold;
        }
        
        .result-box {
            background: #fff5f5;
            border: 2px solid #fc8181;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .result-box.success {
            background: #f0fff4;
            border-color: #68d391;
        }
        
        .highlight {
            background: #fef5e7;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #d35400;
        }
        
        .important {
            color: #e53e3e;
            font-weight: bold;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .copy-btn {
            background: #48bb78;
            padding: 8px 20px;
            font-size: 14px;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” ç”¨æˆ·IDè°ƒè¯•å·¥å…·</h1>
        
        <div class="section">
            <div class="section-title">ğŸ“‹ å½“å‰æƒ…å†µ</div>
            <div class="step">
                <p><strong>é—®é¢˜ï¼š</strong>å‰ç«¯userInfoçš„IDä¸æ•°æ®åº“_idä¸åŒ¹é…</p>
                <p style="margin-top: 10px;">
                    å‰ç«¯æ˜¾ç¤ºï¼š<span class="highlight">67b0b5993f1a473bba2a16789</span> (ç¬¬3ä½æ˜¯<span class="important">b</span>)<br>
                    æ•°æ®åº“_idï¼š<span class="highlight">67d0b5993f1a473bba2a16789</span> (ç¬¬3ä½æ˜¯<span class="important">d</span>)
                </p>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">ğŸš€ æ­¥éª¤1ï¼šåœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·Consoleæ‰§è¡Œ</div>
            <div class="code-block">
<span class="comment">// å¤åˆ¶ä»¥ä¸‹ä»£ç åˆ°Consoleæ‰§è¡Œ</span>
const userInfo = uni.getStorageSync('userInfo')
console.log('=== å®Œæ•´userInfo ===')
console.log(JSON.stringify(userInfo, null, 2))
console.log('\n=== å„å­—æ®µå€¼ ===')
console.log('_id:', userInfo._id)
console.log('uid:', userInfo.uid)
console.log('dcloud_appid:', userInfo.dcloud_appid)
            </div>
            <button class="copy-btn" onclick="copyCode(this.previousElementSibling.innerText)">å¤åˆ¶ä»£ç </button>
            
            <div class="result-box">
                <strong>ğŸ“ è®°å½•è¾“å‡ºç»“æœ</strong>
                <p style="margin-top: 10px;">æ‰¾åˆ°è¿™äº›IDå€¼ï¼Œä¸‹ä¸€æ­¥ä¼šç”¨åˆ°ï¼š</p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li><code>_id</code> çš„å€¼</li>
                    <li><code>uid</code> çš„å€¼</li>
                    <li><code>dcloud_appid</code> çš„å€¼ï¼ˆå¦‚æœæ˜¯æ•°ç»„ï¼Œçœ‹ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰</li>
                </ul>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">ğŸ” æ­¥éª¤2ï¼šè°ƒç”¨è°ƒè¯•äº‘å‡½æ•°</div>
            <div class="code-block">
<span class="comment">// åœ¨Consoleæ‰§è¡Œï¼Œæµ‹è¯•å“ªä¸ªIDèƒ½æŸ¥åˆ°ç”¨æˆ·</span>
const api = uniCloud.importObject('articleWx')
const result = await api.debugUserId({
  test_ids: [
    <span class="string">'67b0b5993f1a473bba2a16789'</span>,  <span class="comment">// userInfo.uid</span>
    <span class="string">'67d0b5993f1a473bba2a16789'</span>,  <span class="comment">// æ•°æ®åº“_id</span>
    <span class="comment">// å¦‚æœè¿˜æœ‰å…¶ä»–å¯èƒ½çš„IDï¼Œä¹ŸåŠ è¿›æ¥</span>
  ]
})
console.log('è°ƒè¯•ç»“æœ:', result)
            </div>
            <button class="copy-btn" onclick="copyCode(this.previousElementSibling.innerText)">å¤åˆ¶ä»£ç </button>
            
            <div class="result-box success">
                <strong>âœ… çœ‹å“ªä¸ªIDçš„æŸ¥è¯¢ç»“æœæ˜¾ç¤º"æ‰¾åˆ°"</strong>
                <p style="margin-top: 10px;">
                    äº‘å‡½æ•°ä¼šå°è¯•3ç§æŸ¥è¯¢æ–¹å¼ï¼š<br>
                    1. <code>doc(id)</code> - æœ€æ ‡å‡†çš„æŸ¥è¯¢<br>
                    2. <code>where({_id})</code> - æ¡ä»¶æŸ¥è¯¢<br>
                    3. <code>where({dcloud_appid})</code> - æ•°ç»„å­—æ®µæŸ¥è¯¢
                </p>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">ğŸ¯ æ­¥éª¤3ï¼šä½¿ç”¨æ­£ç¡®çš„IDæµ‹è¯•è½¬è´¦</div>
            <div class="code-block">
<span class="comment">// ç”¨èƒ½æŸ¥åˆ°ç”¨æˆ·çš„é‚£ä¸ªIDè¿›è¡Œè½¬è´¦æµ‹è¯•</span>
const api = uniCloud.importObject('articleWx')
const result = await api.testCashbackTransfer({
  user_id: <span class="string">'æ­£ç¡®çš„ID'</span>,  <span class="comment">// æ›¿æ¢ä¸ºæ­¥éª¤2æ‰¾åˆ°çš„æ­£ç¡®ID</span>
  amount: 0.3,
  desc: <span class="string">'æµ‹è¯•è½¬è´¦'</span>
})
console.log('è½¬è´¦ç»“æœ:', result)
            </div>
            <button class="copy-btn" onclick="copyCode(this.previousElementSibling.innerText)">å¤åˆ¶ä»£ç </button>
        </div>
        
        <div class="section">
            <div class="section-title">ğŸ”§ æ­¥éª¤4ï¼šä¿®å¤å‰ç«¯ä»£ç </div>
            <p style="margin-bottom: 15px;">æ ¹æ®æ­¥éª¤2çš„ç»“æœï¼Œä¿®æ”¹ <code>testCashback.vue</code>ï¼š</p>
            
            <div class="code-block">
<span class="comment">// å¦‚æœ dcloud_appid[0] èƒ½æŸ¥åˆ°ï¼Œä½¿ç”¨ï¼š</span>
const finalUserId = userInfo.dcloud_appid?.[0] || userInfo._id

<span class="comment">// æˆ–è€…å¦‚æœå…¶ä»–å­—æ®µèƒ½æŸ¥åˆ°ï¼Œä½¿ç”¨å¯¹åº”çš„å­—æ®µ</span>
const finalUserId = userInfo.æ­£ç¡®çš„å­—æ®µå
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">ğŸ“Š å¯èƒ½çš„ç»“æœ</div>
            
            <div class="step">
                <span class="step-number">A</span>
                <strong>å¦‚æœ 67d0b... èƒ½æŸ¥åˆ°</strong>
                <p style="margin-top: 10px; margin-left: 40px;">
                    è¯´æ˜æ•°æ®åº“_idæ˜¯æ­£ç¡®çš„ï¼Œéœ€è¦æ‰¾åˆ°userInfoä¸­å“ªä¸ªå­—æ®µå­˜å‚¨çš„æ˜¯è¿™ä¸ªå€¼ã€‚<br>
                    æ£€æŸ¥ <code>dcloud_appid</code> æ•°ç»„ä¸­æ˜¯å¦åŒ…å«è¿™ä¸ªå€¼ã€‚
                </p>
            </div>
            
            <div class="step">
                <span class="step-number">B</span>
                <strong>å¦‚æœ 67b0b... èƒ½æŸ¥åˆ°</strong>
                <p style="margin-top: 10px; margin-left: 40px;">
                    è¯´æ˜æ•°æ®åº“ä¸­ç¡®å®æœ‰è¿™æ¡è®°å½•ï¼Œç›´æ¥ä½¿ç”¨ <code>userInfo.uid</code> å³å¯ã€‚
                </p>
            </div>
            
            <div class="step">
                <span class="step-number">C</span>
                <strong>å¦‚æœéƒ½æŸ¥ä¸åˆ°</strong>
                <p style="margin-top: 10px; margin-left: 40px;">
                    è¯´æ˜éœ€è¦é‡æ–°ç™»å½•ï¼Œæˆ–è€…æ£€æŸ¥æ•°æ®åº“ä¸­æ˜¯å¦çœŸçš„å­˜åœ¨è¯¥ç”¨æˆ·ã€‚
                </p>
            </div>
        </div>
        
        <div class="result-box">
            <strong>âš ï¸ é‡è¦æç¤º</strong>
            <p style="margin-top: 10px;">
                1. å¿…é¡»å…ˆ<span class="important">ä¸Šä¼ äº‘å‡½æ•°</span>ï¼ˆåŒ…å«æ–°å¢çš„debugUserIdæ–¹æ³•ï¼‰<br>
                2. è®°å½•ä¸‹èƒ½æŸ¥åˆ°ç”¨æˆ·çš„é‚£ä¸ªID<br>
                3. ç”¨æ­£ç¡®çš„IDè¿›è¡Œè½¬è´¦æµ‹è¯•<br>
                4. ä¿®å¤å‰ç«¯ä»£ç ï¼Œä½¿ç”¨æ­£ç¡®çš„å­—æ®µè·å–ç”¨æˆ·ID
            </p>
        </div>
    </div>
    
    <script>
        function copyCode(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            alert('ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
        }
    </script>
</body>
</html>
