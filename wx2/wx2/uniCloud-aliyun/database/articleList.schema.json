{
    "bsonType": "object",
    "required": [
        "user_id",
        "content",
        "create_time"
    ],
    "permission": {
        "read": true,
        "create": "auth.uid != null",
        "update": "auth.uid != null",
        "delete": "auth.uid != null"
    },
    "properties": {
        "_id": {
            "description": "ID，系统自动生成"
        },
        "user_id": {
            "bsonType": "string",
            "description": "发布者ID",
            "foreignKey": "user._id"
        },
        "user_nickName": {
            "bsonType": "string",
            "description": "发布者昵称"
        },
        "user_avatarUrl": {
            "bsonType": "string",
            "description": "发布者头像"
        },
        "user_mobile": {
            "bsonType": "string",
            "description": "发布者电话"
        },
        "content": {
            "bsonType": "string",
            "description": "文章内容",
            "maxLength": 500,
            "trim": "both"
        },
        "images": {
            "bsonType": "array",
            "description": "图片列表",
            "maxItems": 9,
            "items": {
                "bsonType": "object",
                "properties": {
                    "url": {
                        "bsonType": "string",
                        "description": "图片URL（原图）"
                    }
                }
            }
        },
        "videoURL": {
            "bsonType": "string",
            "description": "视频地址"
        },
        "address": {
            "bsonType": "string",
            "description": "发布地址",
            "trim": "both"
        },
        "district": {
            "bsonType": "string",
            "description": "区县"
        },
        "cate_id": {
            "bsonType": "string",
            "description": "分类ID",
            "foreignKey": "cateList._id"
        },
        "like_count": {
            "bsonType": "int",
            "description": "点赞数"
        },
        "look_count": {
            "bsonType": "int",
            "description": "阅读量",
            "minimum": 0,
            "defaultValue": 0
        },
        "comment_count": {
            "bsonType": "int",
            "description": "评论数量",
            "minimum": 0,
            "defaultValue": 0
        },
        "comment_likes": {
            "bsonType": "array",
            "description": "评论点赞记录",
            "items": {
                "bsonType": "object",
                "required": [
                    "comment_id",
                    "user_id",
                    "create_time"
                ],
                "properties": {
                    "comment_id": {
                        "bsonType": "string",
                        "description": "被点赞的评论ID"
                    },
                    "user_id": {
                        "bsonType": "string",
                        "description": "点赞用户ID",
                        "foreignKey": "user._id"
                    },
                    "user_mobile": {
                        "bsonType": "string",
                        "description": "点赞用户手机号",
                        "foreignKey": "user.mobile"
                    },
                    "create_time": {
                        "bsonType": "timestamp",
                        "description": "点赞时间",
                        "defaultValue": {
                            "$env": "now"
                        }
                    }
                }
            }
        },
        "create_time": {
            "bsonType": "timestamp",
            "description": "创建时间",
            "defaultValue": {
                "$env": "now"
            }
        },
        "state": {
            "bsonType": "int",
            "description": "状态：0-待审核 1-已通过 2-已拒绝",
            "minimum": 0,
            "maximum": 2,
            "defaultValue": 1
        },
        "reject_reason": {
            "bsonType": "string",
            "description": "拒绝原因",
            "trim": "both"
        },
        "update_time": {
            "bsonType": "timestamp",
            "description": "更新时间",
            "defaultValue": {
                "$env": "now"
            }
        },
        "selected_tags": {
            "bsonType": "array",
            "description": "用户选择的二级分类标签",
            "items": {
                "bsonType": "string",
                "minLength": 1,
                "maxLength": 10
            },
            "maxItems": 10
        },
        "sub_category_info": {
            "bsonType": "object",
            "description": "二级分类信息",
            "properties": {
                "tags": {
                    "bsonType": "array",
                    "description": "分类标签列表",
                    "items": {
                        "bsonType": "string"
                    }
                },
                "description": {
                    "bsonType": "string",
                    "description": "分类描述"
                }
            }
        },
        "enable_bargain": {
            "bsonType": "bool",
            "description": "是否启用砍价功能",
            "defaultValue": false
        },
        "bargain_initial_price": {
            "bsonType": "number",
            "description": "砍价起始金额",
            "minimum": 0,
            "defaultValue": 0
        },
        "bargain_step": {
            "bsonType": "number",
            "description": "每次砍价金额",
            "minimum": 0.01,
            "defaultValue": 10
        },
        "bargain_end_time": {
            "bsonType": "timestamp",
            "description": "砍价活动结束时间",
            "defaultValue": null
        },
        "bargain_mode": {
            "bsonType": "string",
            "description": "砍价模式: fixed-固定金额, random-随机金额, decrease-递减模式, percentage-百分比",
            "enum": [
                "fixed",
                "random",
                "decrease",
                "percentage"
            ],
            "defaultValue": "random"
        },
        "bargain_min_amount": {
            "bsonType": "number",
            "description": "随机模式最小金额",
            "minimum": 0.01,
            "defaultValue": 1
        },
        "bargain_max_amount": {
            "bsonType": "number",
            "description": "随机模式最大金额",
            "minimum": 0.01,
            "defaultValue": 5
        },
        "bargain_percentage": {
            "bsonType": "number",
            "description": "百分比模式的百分比值",
            "minimum": 0.1,
            "maximum": 100,
            "defaultValue": 1
        },
        "bargain_decrease_rate": {
            "bsonType": "number",
            "description": "递减模式的递减比例",
            "minimum": 0.1,
            "maximum": 1,
            "defaultValue": 0.8
        },
        "bargain_popup_image": {
            "bsonType": "string",
            "description": "砂价成功弹窗图片",
            "defaultValue": ""
        },
        "bargain_popup_text": {
            "bsonType": "string",
            "description": "砂价成功弹窗文字",
            "defaultValue": ""
        },
        "bargain_amount_text": {
            "bsonType": "string",
            "description": "砂价金额自定义文字",
            "defaultValue": ""
        },
        "share_cover_image": {
            "bsonType": "string",
            "description": "自定义分享封面图片URL",
            "defaultValue": "",
            "trim": "both"
        }
    }
}