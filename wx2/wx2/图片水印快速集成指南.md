# å›¾ç‰‡æ°´å°å¿«é€Ÿé›†æˆæŒ‡å—

## ğŸš€ 5åˆ†é’Ÿå¿«é€Ÿé›†æˆ

### æ­¥éª¤1: å¯ç”¨å…¨å±€æ°´å° (1åˆ†é’Ÿ)

åœ¨ [`App.vue`](file://d:\ä»£ç æµ‹è¯•\wx2\wx2\App.vue) ä¸­æ·»åŠ :

```javascript
import { setWatermarkEnabled, updateWatermarkConfig } from '@/utils/domainConfig.js'

export default {
  onLaunch() {
    // å¯ç”¨å…¨å±€æ°´å°
    setWatermarkEnabled(true)
    
    // å¯é€‰: è‡ªå®šä¹‰å…¨å±€æ°´å°é…ç½®
    updateWatermarkConfig({
      text: 'æœ¬ç«™ä¸“å±',
      fontSize: 14,
      opacity: 55,
      position: 'SouthEast'
    })
  }
}
```

### æ­¥éª¤2: åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ (2åˆ†é’Ÿ)

#### æ–¹å¼A: è‡ªåŠ¨æ·»åŠ æ°´å°(æ¨è)

ç°æœ‰çš„ `addListImageParams` å‡½æ•°å·²è‡ªåŠ¨é›†æˆæ°´å°åŠŸèƒ½:

```vue
<script setup>
import { addListImageParams } from '@/utils/domainConfig.js'

// åŸæœ‰ä»£ç ä¸éœ€è¦ä¿®æ”¹,å·²è‡ªåŠ¨æ·»åŠ æ°´å°
const imageUrl = addListImageParams(originalUrl)
</script>

<template>
  <image :src="addListImageParams(imageUrl)" />
</template>
```

#### æ–¹å¼B: ç‹¬ç«‹ä½¿ç”¨æ°´å°å·¥å…·

```vue
<script setup>
import { getWatermarkedImageUrl } from '@/utils/watermarkHelper.js'

const watermarkedUrl = getWatermarkedImageUrl(imageUrl)
</script>

<template>
  <image :src="watermarkedUrl" />
</template>
```

### æ­¥éª¤3: æµ‹è¯•æ•ˆæœ (2åˆ†é’Ÿ)

1. é‡å¯é¡¹ç›®
2. è®¿é—®ä»»æ„åŒ…å«å›¾ç‰‡çš„é¡µé¢
3. æŸ¥çœ‹å›¾ç‰‡å³ä¸‹è§’æ˜¯å¦æ˜¾ç¤ºæ°´å°

---

## ğŸ¯ é’ˆå¯¹ç°æœ‰é¡¹ç›®çš„ä¿®æ”¹å»ºè®®

### 1. æ–‡ç« åˆ—è¡¨ç»„ä»¶ (articleItem.vue)

**ç°çŠ¶**: å·²ä½¿ç”¨ `addListImageParams` å¤„ç†å›¾ç‰‡

**æ“ä½œ**: æ— éœ€ä¿®æ”¹,åªéœ€å¯ç”¨å…¨å±€æ°´å°å³å¯è‡ªåŠ¨ç”Ÿæ•ˆ

**ä½ç½®**: [`components/articleItem/articleItem.vue`](file://d:\ä»£ç æµ‹è¯•\wx2\wx2\components\articleItem\articleItem.vue) ç¬¬315è¡Œ

```javascript
// ç°æœ‰ä»£ç (æ— éœ€ä¿®æ”¹)
const originalUrl = img.thumbnailURL || img.compressedURL || img.url
const processedUrl = fixImageUrl(originalUrl)
```

### 2. æ–‡ç« è¯¦æƒ…é¡µ (articleDetail.vue)

**ç°çŠ¶**: ä½¿ç”¨ `processImageUrl` å¤„ç†å›¾ç‰‡

**å»ºè®®**: ä¸ºè¯¦æƒ…é¡µå›¾ç‰‡æ·»åŠ æ°´å°

**ä½ç½®**: [`pages/article/articleDetail.vue`](file://d:\ä»£ç æµ‹è¯•\wx2\wx2\pages\article\articleDetail.vue) ç¬¬38è¡Œ

**ä¿®æ”¹æ–¹æ¡ˆ**:

```javascript
// ä¿®æ”¹å‰
const processImageUrl = (url) => {
  if (!url) return getDefaultImage('default')
  const fixedUrl = fixImageUrl(url)
  return addListImageParams(fixedUrl)
}

// ä¿®æ”¹å (æ— éœ€æ”¹åŠ¨,addListImageParamså·²é›†æˆæ°´å°)
// å¦‚éœ€è‡ªå®šä¹‰æ°´å°,å¯ä½¿ç”¨:
import { getWatermarkedImageUrl } from '@/utils/watermarkHelper.js'

const processImageUrl = (url) => {
  if (!url) return getDefaultImage('default')
  const fixedUrl = fixImageUrl(url)
  // ä¸ºè¯¦æƒ…é¡µå›¾ç‰‡æ·»åŠ æ›´æ˜æ˜¾çš„æ°´å°
  return getWatermarkedImageUrl(fixedUrl, {
    fontSize: 16,
    opacity: 70
  })
}
```

### 3. é¦–é¡µ (index.vue)

**ç°çŠ¶**: ä½¿ç”¨ `processArticleImages` å¤„ç†å›¾ç‰‡æ•°ç»„

**ä½ç½®**: [`pages/index/index.vue`](file://d:\ä»£ç æµ‹è¯•\wx2\wx2\pages\index\index.vue) ç¬¬709è¡Œ

**æ“ä½œ**: æ— éœ€ä¿®æ”¹,å·²è‡ªåŠ¨åº”ç”¨æ°´å°

```javascript
// ç°æœ‰ä»£ç (å·²é›†æˆæ°´å°,æ— éœ€ä¿®æ”¹)
article.article_img = article.article_img.map(img => {
  return addListImageParams(fixImageUrl(img.url))
})
```

---

## ğŸ”§ é«˜çº§é…ç½®

### åœºæ™¯1: ä¸åŒé¡µé¢ä½¿ç”¨ä¸åŒæ°´å°

```javascript
// åˆ—è¡¨é¡µ: å°æ°´å°
const listUrl = addListImageParams(url, true) // ä½¿ç”¨é»˜è®¤æ°´å°

// è¯¦æƒ…é¡µ: å¤§æ°´å°
import { addQiniuWatermark } from '@/utils/watermarkHelper.js'
const detailUrl = addQiniuWatermark(url, {
  fontSize: 18,
  opacity: 70
})

// é¢„è§ˆé¡µ: æ›´æ˜æ˜¾çš„æ°´å°
const previewUrl = addQiniuWatermark(url, {
  fontSize: 20,
  opacity: 80,
  position: 'Center'
})
```

### åœºæ™¯2: éƒ¨åˆ†å›¾ç‰‡ä¸æ·»åŠ æ°´å°

```javascript
// å¤´åƒä¸æ·»åŠ æ°´å°
const avatarUrl = addListImageParams(url, false)

// åˆ†ç±»å›¾æ ‡ä¸æ·»åŠ æ°´å°
const iconUrl = addListImageParams(iconUrl, false)

// æ–‡ç« å›¾ç‰‡æ·»åŠ æ°´å°
const articleUrl = addListImageParams(articleUrl, true)
```

### åœºæ™¯3: åŠ¨æ€åˆ‡æ¢æ°´å°

```javascript
import { setWatermarkEnabled } from '@/utils/domainConfig.js'

// æ ¹æ®ç”¨æˆ·è®¾ç½®åŠ¨æ€å¯ç”¨/å…³é—­
const toggleWatermark = (enabled) => {
  setWatermarkEnabled(enabled)
  // åˆ·æ–°é¡µé¢æˆ–é‡æ–°åŠ è½½å›¾ç‰‡
}
```

---

## ğŸ“± ç®¡ç†ç•Œé¢

### è®¿é—®æ°´å°é…ç½®é¡µé¢

åœ¨ç®¡ç†å‘˜é¡µé¢æ·»åŠ å…¥å£:

```vue
<template>
  <view class="admin-item" @click="goToWatermarkConfig">
    <uni-icons type="image" size="20"></uni-icons>
    <text>æ°´å°é…ç½®</text>
  </view>
</template>

<script>
const goToWatermarkConfig = () => {
  uni.navigateTo({
    url: '/subPages/watermarkConfig/watermarkConfig'
  })
}
</script>
```

### æŸ¥çœ‹ä½¿ç”¨ç¤ºä¾‹

```javascript
uni.navigateTo({
  url: '/subPages/watermarkDemo/watermarkDemo'
})
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. åˆç†è®¾ç½®é€æ˜åº¦

```javascript
// æ¨è: 50-70% (æ—¢ä¿æŠ¤ç‰ˆæƒåˆä¸å½±å“ç¾è§‚)
opacity: 55

// ä¸æ¨è: è¿‡é«˜ä¼šå½±å“è§‚æ„Ÿ
opacity: 90
```

### 2. é€‰æ‹©åˆé€‚çš„ä½ç½®

```javascript
// æ¨è: å³ä¸‹è§’ (ä¸é®æŒ¡ä¸»ä½“å†…å®¹)
position: 'SouthEast'

// ä¸æ¨è: æ­£ä¸­å¤® (å½±å“è§‚çœ‹)
position: 'Center'
```

### 3. æ§åˆ¶å­—ä½“å¤§å°

```javascript
// åˆ—è¡¨é¡µ: è¾ƒå°
fontSize: 12

// è¯¦æƒ…é¡µ: é€‚ä¸­
fontSize: 14

// é¢„è§ˆé¡µ: è¾ƒå¤§
fontSize: 18
```

---

## ğŸ¨ è§†è§‰æ•ˆæœå‚è€ƒ

### æ¨èé…ç½®æ–¹æ¡ˆ

#### æ–¹æ¡ˆ1: ç®€çº¦é£æ ¼
```javascript
{
  text: 'æœ¬ç«™ä¸“å±',
  fontSize: 12,
  opacity: 45,
  position: 'SouthEast',
  dx: 8,
  dy: 8
}
```

#### æ–¹æ¡ˆ2: é†’ç›®é£æ ¼
```javascript
{
  text: 'ç‰ˆæƒæ‰€æœ‰',
  fontSize: 16,
  opacity: 70,
  position: 'SouthEast',
  dx: 12,
  dy: 12
}
```

#### æ–¹æ¡ˆ3: é˜²ç›—å›¾é£æ ¼
```javascript
{
  text: 'ç¦æ­¢ç›—å›¾',
  fontSize: 18,
  opacity: 80,
  position: 'Center'
}
```

---

## âœ… é›†æˆæ£€æŸ¥æ¸…å•

- [ ] åœ¨ App.vue ä¸­å¯ç”¨å…¨å±€æ°´å°
- [ ] ç¡®è®¤ domainConfig.js å·²å¯¼å…¥æ°´å°å·¥å…·
- [ ] æµ‹è¯•åˆ—è¡¨é¡µå›¾ç‰‡æ˜¯å¦æ˜¾ç¤ºæ°´å°
- [ ] æµ‹è¯•è¯¦æƒ…é¡µå›¾ç‰‡æ˜¯å¦æ˜¾ç¤ºæ°´å°
- [ ] æµ‹è¯•å›¾ç‰‡é¢„è§ˆæ˜¯å¦æ˜¾ç¤ºæ°´å°
- [ ] éªŒè¯å¤´åƒç­‰ç‰¹æ®Šå›¾ç‰‡ä¸æ˜¾ç¤ºæ°´å°
- [ ] è®¿é—®é…ç½®ç®¡ç†é¡µé¢æµ‹è¯•åŠŸèƒ½
- [ ] æŸ¥çœ‹ä½¿ç”¨ç¤ºä¾‹é¡µé¢å­¦ä¹ ç”¨æ³•

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1: æ°´å°ä¸æ˜¾ç¤º

**æ£€æŸ¥æ­¥éª¤**:
1. ç¡®è®¤å…¨å±€æ°´å°å·²å¯ç”¨: `getWatermarkEnabled()`
2. æ£€æŸ¥å›¾ç‰‡æ˜¯å¦ä¸ºä¸ƒç‰›äº‘å›¾ç‰‡ (åŸŸå: `aly2.jingle0350.cn`)
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
4. ç¡®è®¤å›¾ç‰‡URLä¸­æ˜¯å¦åŒ…å«æ°´å°å‚æ•°

**è§£å†³æ–¹æ¡ˆ**:
```javascript
// æ‰“å°è°ƒè¯•ä¿¡æ¯
console.log('æ°´å°å¯ç”¨çŠ¶æ€:', getWatermarkEnabled())
console.log('å¤„ç†åçš„URL:', getWatermarkedImageUrl(imageUrl))
```

### é—®é¢˜2: æ°´å°ä½ç½®ä¸å¯¹

**æ£€æŸ¥**:
- ç¡®è®¤ `position` å‚æ•°æ‹¼å†™æ­£ç¡®
- ç¡®è®¤ `dx` å’Œ `dy` åç§»é‡åˆç†

**è°ƒæ•´**:
```javascript
// å¾®è°ƒä½ç½®
addQiniuWatermark(url, {
  position: 'SouthEast',
  dx: 15,  // å¢åŠ å³ä¾§é—´è·
  dy: 15   // å¢åŠ åº•éƒ¨é—´è·
})
```

### é—®é¢˜3: é€æ˜åº¦è¿‡é«˜/è¿‡ä½

**è°ƒæ•´**:
```javascript
// é€æ˜åº¦èŒƒå›´: 0-100
updateWatermarkConfig({
  opacity: 55  // æ¨èå€¼: 50-70
})
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

é‡åˆ°é—®é¢˜æ—¶:
1. æŸ¥çœ‹å®Œæ•´æ–‡æ¡£: [`å›¾ç‰‡æ°´å°åŠŸèƒ½ä½¿ç”¨è¯´æ˜.md`](file://d:\ä»£ç æµ‹è¯•\wx2\wx2\å›¾ç‰‡æ°´å°åŠŸèƒ½ä½¿ç”¨è¯´æ˜.md)
2. å‚è€ƒç¤ºä¾‹é¡µé¢: `/subPages/watermarkDemo/watermarkDemo`
3. æ£€æŸ¥å·¥å…·æ–‡ä»¶: [`utils/watermarkHelper.js`](file://d:\ä»£ç æµ‹è¯•\wx2\wx2\utils\watermarkHelper.js)

---

**ç¥æ‚¨é›†æˆé¡ºåˆ©! ğŸ‰**
