<cite>
**Referenced Files in This Document**   
- [getOpenid/index.js](file://uniCloud-aliyun/cloudfunctions/getOpenid/index.js)
- [userWx/index.obj.js](file://uniCloud-aliyun/cloudfunctions/userWx/index.obj.js)
- [userWx/decryptPhoneNumber.js](file://uniCloud-aliyun/cloudfunctions/userWx/decryptPhoneNumber.js)
- [store/user.js](file://store/user.js)
- [pages/login/login.vue](file://pages/login/login.vue)
</cite>

## Table of Contents
1. [用户系统](#用户系统)
2. [微信登录流程](#微信登录流程)
3. [手机号解密技术细节](#手机号解密技术细节)
4. [用户状态管理方案](#用户状态管理方案)
5. [登录页面与用户体验](#登录页面与用户体验)
6. [典型场景示例](#典型场景示例)
7. [常见问题排查](#常见问题排查)

## 用户系统

本项目构建了一套完整的基于微信生态的用户认证与管理系统，涵盖了从身份获取、信息创建到本地状态维护的全流程。系统核心由前端Vue组件、Pinia状态管理、云函数服务及数据库持久化组成，实现了安全、高效且用户体验良好的用户体系。

### 核心架构概览

```mermaid
flowchart TD
    A[小程序客户端] --> B{调用 uni.login()}
    B --> C[获取临时登录凭证 code]
    C --> D[调用 getOpenid 云函数]
    D --> E[微信服务器验证 code]
    E --> F[返回 openid 和 session_key]
    F --> G[调用 userWx.loginByPhoneWx]
    G --> H[解密 encryptedData 获取手机号]
    H --> I{用户是否存在?}
    I