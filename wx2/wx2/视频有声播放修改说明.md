# 视频有声播放修改说明

## 修改概述
将文章详情页的视频从默认静音改为默认有声播放。

## 修改内容

### 1. 保持初始状态为有声
**文件**: `pages/article/articleDetail.vue`

- **第298行**: `isMuted` 变量初始值已经是 `false`（有声），无需修改
  ```javascript
  const isMuted = ref(false) // 视频静音状态，默认为有声
  ```

### 2. 移除强制设置静音的代码

#### 2.1 移除 onMounted 第一处静音设置
**位置**: 约第1207-1220行

**修改前**:
```javascript
// 获取视频播放器上下文并设置静音
if (articleDetail.value.videoURL) {
    setTimeout(() => {
        videoContext.value = uni.createVideoContext('articleVideo');
        // 确保视频静音（不暂停播放）
        if (videoContext.value) {
            try {
                isMuted.value = true;
                console.log('视频已设置为静音状态，继续播放');
            } catch (err) {
                console.error('设置视频静音失败:', err);
            }
        }
    }, 300);
}
```

**修改后**:
```javascript
// 获取视频播放器上下文
if (articleDetail.value.videoURL) {
    setTimeout(() => {
        videoContext.value = uni.createVideoContext('articleVideo');
        if (videoContext.value) {
            console.log('视频播放器已初始化，默认有声播放');
        }
    }, 300);
}
```

#### 2.2 移除 onMounted 第二处静音设置
**位置**: 约第1257-1270行

**修改前**:
```javascript
// 获取视频播放器上下文并设置静音
if (articleDetail.value.videoURL) {
    setTimeout(() => {
        videoContext.value = uni.createVideoContext('articleVideo');
        // 确保视频静音（不暂停播放）
        if (videoContext.value) {
            try {
                isMuted.value = true;
                console.log('视频已设置为静音状态，继续播放');
            } catch (err) {
                console.error('设置视频静音失败:', err);
            }
        }
    }, 300);
}
```

**修改后**:
```javascript
// 获取视频播放器上下文
if (articleDetail.value.videoURL) {
    setTimeout(() => {
        videoContext.value = uni.createVideoContext('articleVideo');
        if (videoContext.value) {
            console.log('视频播放器已初始化，默认有声播放');
        }
    }, 300);
}
```

#### 2.3 移除视频加载完成后的静音设置
**位置**: 约第1731-1743行（handleVideoLoad 函数内）

**修改前**:
```javascript
// 视频加载完成后再次确保静音状态（不暂停播放）
if (videoContext.value) {
    try {
        isMuted.value = true;
        console.log('视频加载完成，已确保静音状态，继续播放');
    } catch (err) {
        console.error('视频加载后设置静音失败:', err);
    }
}
```

**修改后**:
```javascript
// 视频加载完成
if (videoContext.value) {
    console.log('视频加载完成，默认有声播放');
}
```

### 3. 保留用户手动控制功能
**位置**: 第301-327行

`toggleMute()` 函数保持不变，用户仍可通过点击音量按钮手动切换静音/有声状态：
- 点击按钮可切换静音状态
- 会显示相应的提示信息（"已静音" 或 "已开启声音"）

## 功能说明

### 当前行为
1. **默认状态**: 视频自动播放时有声音
2. **用户控制**: 用户可点击右下角的音量按钮切换静音/有声
3. **状态提示**: 切换时会显示 Toast 提示当前状态

### 音量控制按钮
- **位置**: 视频播放器右下角
- **图标**: 
  - 有声时显示喇叭图标（sound-filled）
  - 静音时显示静音图标（micoff-filled）
- **功能**: 点击可切换静音/有声状态

## 测试建议
1. 刷新页面，确认视频自动播放时有声音
2. 点击音量按钮，验证可以切换到静音状态
3. 再次点击音量按钮，验证可以恢复有声状态
4. 检查 Toast 提示信息是否正确显示

## 修改时间
2025-10-27

## 注意事项
- 由于部分浏览器或微信小程序的限制，自动播放可能受到影响
- 建议在真机上测试效果
- 如需恢复默认静音，可将 `isMuted.value` 初始值改为 `true`，并恢复相应的静音设置代码
