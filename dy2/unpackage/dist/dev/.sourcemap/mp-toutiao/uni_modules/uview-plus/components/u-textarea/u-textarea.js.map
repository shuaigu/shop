{"version":3,"file":"u-textarea.js","sources":["uni_modules/uview-plus/components/u-textarea/u-textarea.vue","D:/代码测试/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTovZHkyL3VuaV9tb2R1bGVzL3V2aWV3LXBsdXMvY29tcG9uZW50cy91LXRleHRhcmVhL3UtdGV4dGFyZWEudnVl"],"sourcesContent":["<template>\n    <view class=\"u-textarea\" :class=\"textareaClass\" :style=\"[textareaStyle]\">\n        <textarea\n            class=\"u-textarea__field\"\n            :value=\"innerValue\"\n            :style=\"{ height: addUnit(height) }\"\n            :placeholder=\"placeholder\"\n            :placeholder-style=\"addStyle(placeholderStyle, typeof placeholderStyle === 'string' ? 'string' : 'object')\"\n            :placeholder-class=\"placeholderClass\"\n            :disabled=\"disabled\"\n            :focus=\"focus\"\n            :autoHeight=\"autoHeight\"\n            :fixed=\"fixed\"\n            :cursorSpacing=\"cursorSpacing\"\n            :cursor=\"cursor\"\n            :showConfirmBar=\"showConfirmBar\"\n            :selectionStart=\"selectionStart\"\n            :selectionEnd=\"selectionEnd\"\n            :adjustPosition=\"adjustPosition\"\n            :disableDefaultPadding=\"disableDefaultPadding\"\n            :holdKeyboard=\"holdKeyboard\"\n            :maxlength=\"maxlength\"\n            :confirm-type=\"confirmType\"\n            :ignoreCompositionEvent=\"ignoreCompositionEvent\"\n            @focus=\"onFocus\"\n            @blur=\"onBlur\"\n            @linechange=\"onLinechange\"\n            @input=\"onInput\"\n            @confirm=\"onConfirm\"\n            @keyboardheightchange=\"onKeyboardheightchange\"\n        ></textarea>\n\t\t<!-- #ifndef MP-ALIPAY -->\n        <text\n            class=\"u-textarea__count\"\n            :style=\"{\n                'background-color': disabled ? 'transparent' : '#fff',\n            }\"\n            v-if=\"count\"\n            >{{ innerValue.length }}/{{ maxlength }}</text\n        >\n\t\t<!-- #endif -->\n    </view>\n</template>\n\n<script>\nimport { props } from \"./props.js\";\nimport { mpMixin } from '../../libs/mixin/mpMixin';\nimport { mixin } from '../../libs/mixin/mixin';\nimport { addStyle, addUnit, deepMerge, formValidate, os } from '../../libs/function/index';\n/**\n * Textarea 文本域\n * @description 文本域此组件满足了可能出现的表单信息补充，编辑等实际逻辑的功能，内置了字数校验等\n * @tutorial https://ijry.github.io/uview-plus/components/textarea.html\n *\n * @property {String | Number} \t\tvalue\t\t\t\t\t输入框的内容\n * @property {String | Number}\t\tplaceholder\t\t\t\t输入框为空时占位符\n * @property {String}\t\t\t    placeholderClass\t\t指定placeholder的样式类，注意页面或组件的style中写了scoped时，需要在类名前写/deep/ （ 默认 'input-placeholder' ）\n * @property {String | Object}\t    placeholderStyle\t\t指定placeholder的样式，字符串/对象形式，如\"color: red;\"\n * @property {String | Number}\t\theight\t\t\t\t\t输入框高度（默认 70 ）\n * @property {String}\t\t\t\tconfirmType\t\t\t\t设置键盘右下角按钮的文字，仅微信小程序，App-vue和H5有效（默认 'done' ）\n * @property {Boolean}\t\t\t\tdisabled\t\t\t\t是否禁用（默认 false ）\n * @property {Boolean}\t\t\t\tcount\t\t\t\t\t是否显示统计字数（默认 false ）\n * @property {Boolean}\t\t\t\tfocus\t\t\t\t\t是否自动获取焦点，nvue不支持，H5取决于浏览器的实现（默认 false ）\n * @property {Boolean | Function}\tautoHeight\t\t\t\t是否自动增加高度（默认 false ）\n * @property {Boolean}\t\t\t\tfixed\t\t\t\t\t如果textarea是在一个position:fixed的区域，需要显示指定属性fixed为true（默认 false ）\n * @property {Number}\t\t\t\tcursorSpacing\t\t\t指定光标与键盘的距离（默认 0 ）\n * @property {String | Number}\t\tcursor\t\t\t\t\t指定focus时的光标位置\n * @property {Function}\t\t\t    formatter\t\t\t    内容式化函数\n * @property {Boolean}\t\t\t\tshowConfirmBar\t\t\t是否显示键盘上方带有”完成“按钮那一栏，（默认 true ）\n * @property {Number}\t\t\t\tselectionStart\t\t\t光标起始位置，自动聚焦时有效，需与selection-end搭配使用，（默认 -1 ）\n * @property {Number | Number}\t\tselectionEnd\t\t\t光标结束位置，自动聚焦时有效，需与selection-start搭配使用（默认 -1 ）\n * @property {Boolean}\t\t\t\tadjustPosition\t\t\t键盘弹起时，是否自动上推页面（默认 true ）\n * @property {Boolean | Number}\t\tdisableDefaultPadding\t是否去掉 iOS 下的默认内边距，只微信小程序有效（默认 false ）\n * @property {Boolean}\t\t\t\tholdKeyboard\t\t\tfocus时，点击页面的时候不收起键盘，只微信小程序有效（默认 false ）\n * @property {String | Number}\t\tmaxlength\t\t\t\t最大输入长度，设置为 -1 的时候不限制最大长度（默认 140 ）\n * @property {String}\t\t\t\tborder\t\t\t\t\t边框类型，surround-四周边框，none-无边框，bottom-底部边框（默认 'surround' ）\n * @property {Boolean}\t\t\t\tignoreCompositionEvent\t是否忽略组件内对文本合成系统事件的处理\n *\n * @event {Function(e)} focus\t\t\t\t\t输入框聚焦时触发，event.detail = { value, height }，height 为键盘高度\n * @event {Function(e)} blur\t\t\t\t\t输入框失去焦点时触发，event.detail = {value, cursor}\n * @event {Function(e)} linechange\t\t\t\t输入框行数变化时调用，event.detail = {height: 0, heightRpx: 0, lineCount: 0}\n * @event {Function(e)} input\t\t\t\t\t当键盘输入时，触发 input 事件\n * @event {Function(e)} confirm\t\t\t\t\t点击完成时， 触发 confirm 事件\n * @event {Function(e)} keyboardheightchange\t键盘高度发生变化的时候触发此事件\n * @example <up-textarea v-model=\"value1\" placeholder=\"请输入内容\" ></up-textarea>\n */\nexport default {\n    name: \"u-textarea\",\n    mixins: [mpMixin, mixin, props],\n\tdata() {\n\t\treturn {\n\t\t\t// 输入框的值\n\t\t\tinnerValue: \"\",\n\t\t\t// 是否处于获得焦点状态\n\t\t\tfocused: false,\n\t\t\t// value是否第一次变化，在watch中，由于加入immediate属性，会在第一次触发，此时不应该认为value发生了变化\n\t\t\tfirstChange: true,\n\t\t\t// value绑定值的变化是由内部还是外部引起的\n\t\t\tchangeFromInner: false,\n\t\t\t// 过滤处理方法\n\t\t\tinnerFormatter: value => value\n\t\t}\n\t},\n\tcreated() {\n\t},\n\twatch: {\n        // #ifdef VUE2\n\t    value: {\n\t        immediate: true,\n\t        handler(newVal, oldVal) {\n\t            this.innerValue = newVal;\n\t            /* #ifdef H5 */\n\t            // 在H5中，外部value变化后，修改input中的值，不会触发@input事件，此时手动调用值变化方法\n\t            if (\n\t                this.firstChange === false &&\n\t                this.changeFromInner === false\n\t            ) {\n\t                this.valueChange();\n\t            }\n\t            /* #endif */\n\t            this.firstChange = false;\n\t            // 重置changeFromInner的值为false，标识下一次引起默认为外部引起的\n\t            this.changeFromInner = false;\n\t        },\n\t    },\n        // #endif\n        // #ifdef VUE3\n        modelValue: {\n\t        immediate: true,\n\t        handler(newVal, oldVal) {\n\t            this.innerValue = newVal;\n\t            /* #ifdef H5 */\n\t            // 在H5中，外部value变化后，修改input中的值，不会触发@input事件，此时手动调用值变化方法\n\t            if (\n\t                this.firstChange === false &&\n\t                this.changeFromInner === false\n\t            ) {\n\t                this.valueChange();\n\t            }\n\t            /* #endif */\n\t            this.firstChange = false;\n\t            // 重置changeFromInner的值为false，标识下一次引起默认为外部引起的\n\t            this.changeFromInner = false;\n\t        },\n\t    }\n        // #endif\n\t},\n    computed: {\n        // 组件的类名\n        textareaClass() {\n            let classes = [],\n                { border, disabled } = this;\n            border === \"surround\" &&\n                (classes = classes.concat([\"u-border\", \"u-textarea--radius\"]));\n            border === \"bottom\" &&\n                (classes = classes.concat([\n                    \"u-border-bottom\",\n                    \"u-textarea--no-radius\",\n                ]));\n            disabled && classes.push(\"u-textarea--disabled\");\n            return classes.join(\" \");\n        },\n        // 组件的样式\n        textareaStyle() {\n            const style = {};\n            // #ifdef APP-NVUE\n            // 由于textarea在安卓nvue上的差异性，需要额外再调整其内边距\n            if (os() === \"android\") {\n                style.paddingTop = \"6px\";\n                style.paddingLeft = \"9px\";\n                style.paddingBottom = \"3px\";\n                style.paddingRight = \"6px\";\n            }\n            // #endif\n            return deepMerge(style, addStyle(this.customStyle));\n        },\n    },\n    // #ifdef VUE3\n    emits: ['update:modelValue', 'linechange', 'focus', 'blur', 'change', 'confirm', 'keyboardheightchange'],\n    // #endif\n    methods: {\n        addStyle,\n        addUnit,\n\t\t// 在微信小程序中，不支持将函数当做props参数，故只能通过ref形式调用\n\t\tsetFormatter(e) {\n\t\t\tthis.innerFormatter = e\n\t\t},\n        onFocus(e) {\n            this.$emit(\"focus\", e);\n        },\n        onBlur(e) {\n            this.$emit(\"blur\", e);\n            // 尝试调用u-form的验证方法\n            formValidate(this, \"blur\");\n        },\n        onLinechange(e) {\n            this.$emit(\"linechange\", e);\n        },\n        onInput(e) {\n\t\t\tlet { value = \"\" } = e.detail || {};\n\t\t\t// 格式化过滤方法\n\t\t\tconst formatter = this.formatter || this.innerFormatter\n\t\t\tconst formatValue = formatter(value)\n\t\t\t// 为了避免props的单向数据流特性，需要先将innerValue值设置为当前值，再在$nextTick中重新赋予设置后的值才有效\n\t\t\tthis.innerValue = value\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.innerValue = formatValue;\n\t\t\t\tthis.valueChange();\n\t\t\t})\n        },\n\t\t// 内容发生变化，进行处理\n\t\tvalueChange() {\n\t\t    const value = this.innerValue;\n\t\t    this.$nextTick(() => {\n                // #ifdef VUE3\n                this.$emit(\"update:modelValue\", value);\n                // #endif\n                // #ifdef VUE2\n                this.$emit(\"input\", value);\n                // #endif\n\t\t        // 标识value值的变化是由内部引起的\n\t\t        this.changeFromInner = true;\n\t\t        this.$emit(\"change\", value);\n\t\t        // 尝试调用u-form的验证方法\n\t\t        formValidate(this, \"change\");\n\t\t    });\n\t\t},\n        onConfirm(e) {\n            this.$emit(\"confirm\", e);\n        },\n        onKeyboardheightchange(e) {\n            this.$emit(\"keyboardheightchange\", e);\n        },\n    },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"../../libs/css/components.scss\";\n\n.u-textarea {\n    border-radius: 4px;\n    background-color: #fff;\n    position: relative;\n    @include flex;\n    flex: 1;\n\tpadding: 9px;\n\n    &--radius {\n        border-radius: 4px;\n    }\n\n    &--no-radius {\n        border-radius: 0;\n    }\n\n    &--disabled {\n        background-color: #f5f7fa;\n    }\n\n    &__field {\n        flex: 1;\n        font-size: 15px;\n        color: $u-content-color;\n\t\twidth: 100%;\n    }\n\n    &__count {\n        position: absolute;\n        right: 5px;\n        bottom: 2px;\n        font-size: 12px;\n        color: $u-tips-color;\n        background-color: #ffffff;\n        padding: 1px 4px;\n    }\n}\n</style>\n","import Component from 'E:/dy2/uni_modules/uview-plus/components/u-textarea/u-textarea.vue'\ntt.createComponent(Component)"],"names":["mpMixin","mixin","props","deepMerge","addStyle","addUnit","formValidate"],"mappings":";;;;;;AAsFA,MAAK,YAAU;AAAA,EACX,MAAM;AAAA,EACN,QAAQ,CAACA,yCAAAA,SAASC,uCAAK,OAAEC,sDAAK;AAAA,EACjC,OAAO;AACN,WAAO;AAAA;AAAA,MAEN,YAAY;AAAA;AAAA,MAEZ,SAAS;AAAA;AAAA,MAET,aAAa;AAAA;AAAA,MAEb,iBAAiB;AAAA;AAAA,MAEjB,gBAAgB,WAAS;AAAA,IAC1B;AAAA,EACA;AAAA,EACD,UAAU;AAAA,EACT;AAAA,EACD,OAAO;AAAA,IAsBA,YAAY;AAAA,MACX,WAAW;AAAA,MACX,QAAQ,QAAQ,QAAQ;AACpB,aAAK,aAAa;AAUlB,aAAK,cAAc;AAEnB,aAAK,kBAAkB;AAAA,MAC1B;AAAA,IACL;AAAA,EAEH;AAAA,EACE,UAAU;AAAA;AAAA,IAEN,gBAAgB;AACZ,UAAI,UAAU,CAAE,GACZ,EAAE,QAAQ,SAAS,IAAI;AAC3B,iBAAW,eACN,UAAU,QAAQ,OAAO,CAAC,YAAY,oBAAoB,CAAC;AAChE,iBAAW,aACN,UAAU,QAAQ,OAAO;AAAA,QACtB;AAAA,QACA;AAAA,MACH,CAAA;AACL,kBAAY,QAAQ,KAAK,sBAAsB;AAC/C,aAAO,QAAQ,KAAK,GAAG;AAAA,IAC1B;AAAA;AAAA,IAED,gBAAgB;AACZ,YAAM,QAAQ,CAAA;AAUd,aAAOC,0CAAAA,UAAU,OAAOC,0CAAAA,SAAS,KAAK,WAAW,CAAC;AAAA,IACrD;AAAA,EACJ;AAAA,EAED,OAAO,CAAC,qBAAqB,cAAc,SAAS,QAAQ,UAAU,WAAW,sBAAsB;AAAA,EAEvG,SAAS;AAAA,IACL,UAAAA,0CAAQ;AAAA,IACR,SAAAC,0CAAO;AAAA;AAAA,IAEb,aAAa,GAAG;AACf,WAAK,iBAAiB;AAAA,IACtB;AAAA,IACK,QAAQ,GAAG;AACP,WAAK,MAAM,SAAS,CAAC;AAAA,IACxB;AAAA,IACD,OAAO,GAAG;AACN,WAAK,MAAM,QAAQ,CAAC;AAEpBC,6DAAa,MAAM,MAAM;AAAA,IAC5B;AAAA,IACD,aAAa,GAAG;AACZ,WAAK,MAAM,cAAc,CAAC;AAAA,IAC7B;AAAA,IACD,QAAQ,GAAG;AAChB,UAAI,EAAE,QAAQ,GAAG,IAAI,EAAE,UAAU,CAAA;AAEjC,YAAM,YAAY,KAAK,aAAa,KAAK;AACzC,YAAM,cAAc,UAAU,KAAK;AAEnC,WAAK,aAAa;AAClB,WAAK,UAAU,MAAM;AACpB,aAAK,aAAa;AAClB,aAAK,YAAW;AAAA,OAChB;AAAA,IACK;AAAA;AAAA,IAEP,cAAc;AACV,YAAM,QAAQ,KAAK;AACnB,WAAK,UAAU,MAAM;AAEX,aAAK,MAAM,qBAAqB,KAAK;AAM3C,aAAK,kBAAkB;AACvB,aAAK,MAAM,UAAU,KAAK;AAE1BA,+DAAa,MAAM,QAAQ;AAAA,MAC/B,CAAC;AAAA,IACJ;AAAA,IACK,UAAU,GAAG;AACT,WAAK,MAAM,WAAW,CAAC;AAAA,IAC1B;AAAA,IACD,uBAAuB,GAAG;AACtB,WAAK,MAAM,wBAAwB,CAAC;AAAA,IACvC;AAAA,EACJ;AACL;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzOA,GAAG,gBAAgB,SAAS;"}