{"version":3,"file":"user.js","sources":["store/user.js"],"sourcesContent":["import { defineStore } from 'pinia'\nimport { ref } from 'vue'\n\nexport const useUserInfoStore = defineStore( 'userInfo', ( ) => {\n\t// 默认用户数据\n\tconst defaultUserInfo = {\n\t\tuid: '', //本地平台ID\n\t\tnickName: \"\", //昵称\n\t\tavatarUrl: \"/static/images/defalut.png\", //头像地址\n\t\tmobile: \"未填写\", //手机号码\n\t\tisLogin: false, //登录状态\n\t\trole: [ ], //默认角色\n\t}\n\n\t// 初始化用户数据\n\tconst userInfo = ref( {\n\t\t...defaultUserInfo\n\t} )\n\n\t// 设置用户数据\n\tconst setUserInfo = ( obj = {} ) => {\n\t\tuserInfo.value = obj\n\t}\n\t\n\t// 处理登录成功，保存用户信息到本地\n\tconst login = (userData) => {\n\t\t// 更新用户信息\n\t\tuserInfo.value = {\n\t\t\t...userData,\n\t\t\tisLogin: true\n\t\t}\n\t\t// 将用户信息保存到本地存储\n\t\tuni.setStorageSync('userInfo', userInfo.value)\n\t\treturn userInfo.value\n\t}\n\n\t// 清空用户数据\n\tconst cleanUserInfo = ( ) => {\n\t\tuserInfo.value = {\n\t\t\t...defaultUserInfo // 恢复默认值\n\t\t}\n\t\tlikeRecords.value = [ ] // 清空点赞记录\n\t\t// 清除本地存储\n\t\tuni.removeStorageSync('userInfo')\n\t}\n\n\t// 更新用户头像\n\tconst updateUserAvatar = (avatarUrl) => {\n\t\tuserInfo.value.avatarUrl = avatarUrl\n\t\t// 将更新同步到本地存储\n\t\tuni.setStorageSync('userInfo', userInfo.value)\n\t}\n\t\n\t// 更新用户昵称\n\tconst updateUserNickName = (nickName) => {\n\t\tuserInfo.value.nickName = nickName\n\t\t// 将更新同步到本地存储\n\t\tuni.setStorageSync('userInfo', userInfo.value)\n\t}\n\n\t// 存储点赞记录\n\tconst likeRecords = ref( [ ] )\n\n\t// 设置点赞记录\n\tconst setLikeRecords = ( records ) => {\n\t\tlikeRecords.value = records\n\t}\n\n\t// 检查是否点赞过某篇文章\n\tconst isLiked = ( article_id ) => {\n\t\treturn likeRecords.value.some( ( record ) => record.article_id === article_id )\n\t}\n\n\treturn {\n\t\tuserInfo,\n\t\tsetUserInfo,\n\t\tlogin,\n\t\tcleanUserInfo,\n\t\tupdateUserAvatar,\n\t\tupdateUserNickName,\n\t\tlikeRecords,\n\t\tsetLikeRecords,\n\t\tisLiked\n\t}\n}, {\n\tpersist: {\n\t\t// 使用 uni storage 代替 localStorage\n\t\tstorage: {\n\t\t\tgetItem( key ) {\n\t\t\t\treturn uni.getStorageSync( key )\n\t\t\t},\n\t\t\tsetItem( key, value ) {\n\t\t\t\tuni.setStorageSync( key, value )\n\t\t\t}\n\t\t},\n\t}\n} )"],"names":["defineStore","ref","uni"],"mappings":";;AAGY,MAAC,mBAAmBA,cAAAA,YAAa,YAAY,MAAO;AAE/D,QAAM,kBAAkB;AAAA,IACvB,KAAK;AAAA;AAAA,IACL,UAAU;AAAA;AAAA,IACV,WAAW;AAAA;AAAA,IACX,QAAQ;AAAA;AAAA,IACR,SAAS;AAAA;AAAA,IACT,MAAM,CAAG;AAAA;AAAA,EACT;AAGD,QAAM,WAAWC,cAAAA,IAAK;AAAA,IACrB,GAAG;AAAA,EACL,CAAI;AAGH,QAAM,cAAc,CAAE,MAAM,OAAQ;AACnC,aAAS,QAAQ;AAAA,EACjB;AAGD,QAAM,QAAQ,CAAC,aAAa;AAE3B,aAAS,QAAQ;AAAA,MAChB,GAAG;AAAA,MACH,SAAS;AAAA,IACT;AAEDC,kBAAAA,MAAI,eAAe,YAAY,SAAS,KAAK;AAC7C,WAAO,SAAS;AAAA,EAChB;AAGD,QAAM,gBAAgB,MAAO;AAC5B,aAAS,QAAQ;AAAA,MAChB,GAAG;AAAA;AAAA,IACH;AACD,gBAAY,QAAQ,CAAG;AAEvBA,kBAAG,MAAC,kBAAkB,UAAU;AAAA,EAChC;AAGD,QAAM,mBAAmB,CAAC,cAAc;AACvC,aAAS,MAAM,YAAY;AAE3BA,kBAAAA,MAAI,eAAe,YAAY,SAAS,KAAK;AAAA,EAC7C;AAGD,QAAM,qBAAqB,CAAC,aAAa;AACxC,aAAS,MAAM,WAAW;AAE1BA,kBAAAA,MAAI,eAAe,YAAY,SAAS,KAAK;AAAA,EAC7C;AAGD,QAAM,cAAcD,cAAG,IAAE,EAAK;AAG9B,QAAM,iBAAiB,CAAE,YAAa;AACrC,gBAAY,QAAQ;AAAA,EACpB;AAGD,QAAM,UAAU,CAAE,eAAgB;AACjC,WAAO,YAAY,MAAM,KAAM,CAAE,WAAY,OAAO,eAAe,UAAY;AAAA,EAC/E;AAED,SAAO;AAAA,IACN;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACA;AACF,GAAG;AAAA,EACF,SAAS;AAAA;AAAA,IAER,SAAS;AAAA,MACR,QAAS,KAAM;AACd,eAAOC,cAAG,MAAC,eAAgB,GAAK;AAAA,MAChC;AAAA,MACD,QAAS,KAAK,OAAQ;AACrBA,4BAAI,eAAgB,KAAK,KAAO;AAAA,MAChC;AAAA,IACD;AAAA,EACD;AACF,CAAC;;"}