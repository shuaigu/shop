{"version":3,"file":"user.js","sources":["store/user.js"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport { ref } from 'vue'\r\n\r\nexport const useUserInfoStore = defineStore( 'userInfo', ( ) => {\r\n\t// 默认用户数据\r\n\tconst defaultUserInfo = {\r\n\t\tuid: '', //本地平台ID\r\n\t\tnickName: \"\", //昵称\r\n\t\tavatarUrl: \"/static/images/touxiang.png\", //头像地址\r\n\t\tmobile: \"未填写\", //手机号码\r\n\t\tisLogin: false, //登录状态\r\n\t\trole: [ ], //默认角色\r\n\t}\r\n\r\n\t// 初始化用户数据\r\n\tconst userInfo = ref( {\r\n\t\t...defaultUserInfo\r\n\t} )\r\n\r\n\t// 设置用户数据\r\n\tconst setUserInfo = ( obj = {} ) => {\r\n\t\tuserInfo.value = obj\r\n\t\t// 确保设置isLogin状态\r\n\t\tif (obj && obj.uid) {\r\n\t\t\tuserInfo.value.isLogin = true\r\n\t\t} else {\r\n\t\t\tuserInfo.value.isLogin = false\r\n\t\t}\r\n\t\t// 将更新同步到本地存储\r\n\t\tuni.setStorageSync('userInfo', userInfo.value)\r\n\t}\r\n\r\n\t// 清空用户数据\r\n\tconst cleanUserInfo = ( ) => {\r\n\t\tuserInfo.value = {\r\n\t\t\t...defaultUserInfo // 恢复默认值\r\n\t\t}\r\n\t\tlikeRecords.value = [ ] // 清空点赞记录\r\n\t}\r\n\r\n\t// 更新用户头像\r\n\tconst updateUserAvatar = (avatarUrl) => {\r\n\t\tuserInfo.value.avatarUrl = avatarUrl\r\n\t\t// 将更新同步到本地存储\r\n\t\tuni.setStorageSync('userInfo', userInfo.value)\r\n\t}\r\n\t\r\n\t// 更新用户昵称\r\n\tconst updateUserNickName = (nickName) => {\r\n\t\tuserInfo.value.nickName = nickName\r\n\t\t// 将更新同步到本地存储\r\n\t\tuni.setStorageSync('userInfo', userInfo.value)\r\n\t}\r\n\r\n\t// 存储点赞记录\r\n\tconst likeRecords = ref( [ ] )\r\n\r\n\t// 设置点赞记录\r\n\tconst setLikeRecords = ( records ) => {\r\n\t\tlikeRecords.value = records\r\n\t}\r\n\r\n\t// 检查是否点赞过某篇文章\r\n\tconst isLiked = ( article_id ) => {\r\n\t\treturn likeRecords.value.some( ( record ) => record.article_id === article_id )\r\n\t}\r\n\r\n\treturn {\r\n\t\tuserInfo,\r\n\t\tsetUserInfo,\r\n\t\tcleanUserInfo,\r\n\t\tupdateUserAvatar,\r\n\t\tupdateUserNickName,\r\n\t\tlikeRecords,\r\n\t\tsetLikeRecords,\r\n\t\tisLiked\r\n\t}\r\n}, {\r\n\tpersist: {\r\n\t\t// 使用 uni storage 代替 localStorage\r\n\t\tstorage: {\r\n\t\t\tgetItem( key ) {\r\n\t\t\t\treturn uni.getStorageSync( key )\r\n\t\t\t},\r\n\t\t\tsetItem( key, value ) {\r\n\t\t\t\tuni.setStorageSync( key, value )\r\n\t\t\t}\r\n\t\t},\r\n\t}\r\n} )"],"names":["defineStore","ref","uni"],"mappings":";;AAGY,MAAC,mBAAmBA,cAAAA,YAAa,YAAY,MAAO;AAE/D,QAAM,kBAAkB;AAAA,IACvB,KAAK;AAAA;AAAA,IACL,UAAU;AAAA;AAAA,IACV,WAAW;AAAA;AAAA,IACX,QAAQ;AAAA;AAAA,IACR,SAAS;AAAA;AAAA,IACT,MAAM,CAAG;AAAA;AAAA,EACT;AAGD,QAAM,WAAWC,cAAAA,IAAK;AAAA,IACrB,GAAG;AAAA,EACL,CAAI;AAGH,QAAM,cAAc,CAAE,MAAM,OAAQ;AACnC,aAAS,QAAQ;AAEjB,QAAI,OAAO,IAAI,KAAK;AACnB,eAAS,MAAM,UAAU;AAAA,IAC5B,OAAS;AACN,eAAS,MAAM,UAAU;AAAA,IACzB;AAEDC,kBAAAA,MAAI,eAAe,YAAY,SAAS,KAAK;AAAA,EAC7C;AAGD,QAAM,gBAAgB,MAAO;AAC5B,aAAS,QAAQ;AAAA,MAChB,GAAG;AAAA;AAAA,IACH;AACD,gBAAY,QAAQ,CAAG;AAAA,EACvB;AAGD,QAAM,mBAAmB,CAAC,cAAc;AACvC,aAAS,MAAM,YAAY;AAE3BA,kBAAAA,MAAI,eAAe,YAAY,SAAS,KAAK;AAAA,EAC7C;AAGD,QAAM,qBAAqB,CAAC,aAAa;AACxC,aAAS,MAAM,WAAW;AAE1BA,kBAAAA,MAAI,eAAe,YAAY,SAAS,KAAK;AAAA,EAC7C;AAGD,QAAM,cAAcD,cAAG,IAAE,EAAK;AAG9B,QAAM,iBAAiB,CAAE,YAAa;AACrC,gBAAY,QAAQ;AAAA,EACpB;AAGD,QAAM,UAAU,CAAE,eAAgB;AACjC,WAAO,YAAY,MAAM,KAAM,CAAE,WAAY,OAAO,eAAe,UAAY;AAAA,EAC/E;AAED,SAAO;AAAA,IACN;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACA;AACF,GAAG;AAAA,EACF,SAAS;AAAA;AAAA,IAER,SAAS;AAAA,MACR,QAAS,KAAM;AACd,eAAOC,cAAG,MAAC,eAAgB,GAAK;AAAA,MAChC;AAAA,MACD,QAAS,KAAK,OAAQ;AACrBA,4BAAI,eAAgB,KAAK,KAAO;AAAA,MAChC;AAAA,IACD;AAAA,EACD;AACF,CAAC;;"}